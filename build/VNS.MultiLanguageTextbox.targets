<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0"
	xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

	<!-- Copy files after build -->
	<Target Name="CopyVNSMultiLanguageTextboxFiles" AfterTargets="Build" Condition="'$(IsCrossTargetingBuild)' != 'true'">
		<ItemGroup>
			<VNSFiles Include="$(MSBuildThisFileDirectory)..\content\App_Plugins\VNS.MultiLanguageTextbox\**\*.*" />
		</ItemGroup>

		<!-- Copy to project wwwroot (for dotnet run/watch) - only if NOT publishing -->
		<Copy SourceFiles="@(VNSFiles)" DestinationFiles="@(VNSFiles->'$(ProjectDir)wwwroot\App_Plugins\VNS.MultiLanguageTextbox\%(RecursiveDir)%(Filename)%(Extension)')" SkipUnchangedFiles="true" Condition="'$(DeployOnBuild)' != 'true'" />

		<!-- Copy to output directory -->
		<Copy SourceFiles="@(VNSFiles)" DestinationFiles="@(VNSFiles->'$(OutputPath)wwwroot\App_Plugins\VNS.MultiLanguageTextbox\%(RecursiveDir)%(Filename)%(Extension)')" SkipUnchangedFiles="true" />
	</Target>

	<!-- Clean project wwwroot before publish to avoid conflicts -->
	<Target Name="CleanVNSMultiLanguageTextboxFiles" BeforeTargets="PrepareForPublish">
		<ItemGroup>
			<VNSFilesToClean Include="$(ProjectDir)wwwroot\App_Plugins\VNS.MultiLanguageTextbox\**\*.*" />
		</ItemGroup>
		<Delete Files="@(VNSFilesToClean)" />
	</Target>

	<!-- Copy files during publish -->
	<Target Name="PublishVNSMultiLanguageTextboxFiles" AfterTargets="ComputeFilesToPublish">
		<ItemGroup>
			<VNSFiles Include="$(MSBuildThisFileDirectory)..\content\App_Plugins\VNS.MultiLanguageTextbox\**\*.*" />
		</ItemGroup>

		<ItemGroup>
			<ResolvedFileToPublish Include="@(VNSFiles)">
				<RelativePath>wwwroot\App_Plugins\VNS.MultiLanguageTextbox\%(RecursiveDir)%(Filename)%(Extension)</RelativePath>
				<CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
			</ResolvedFileToPublish>
		</ItemGroup>
	</Target>

</Project>
